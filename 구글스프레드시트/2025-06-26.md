# 구글스프레드 시트
- excel과 달리 무료로 구글에서 제공

# 데이터 가공
### 상대참조와 절대참조
- 상대참조: = a1
- 절대참조: = $a$1
- 열고정: = $a1
- 행고정: = a$1
- 상대참조: c1셀에 =a1을 입력한뒤에 오른쪽 아래에 있는 점을 드래그해서 복사붙여넣기 하면 이동한 만큼의 행과 열만큼 주소가 바뀜
- $가 붙은 행이나 열은 절대 바뀌지 않음

### 기본 함수들
- 무조건 `=` 으로 시작

```
x:y -> x행부터 y행까지의 행의 개수를 셈
sum: 어떤 범위의 합계를 리턴
average: 어떤 범위의 평균값을 리턴
사칙연산
max : 어떤 범위의 최댓값을 리턴
min : 범위의 최솟값을 리턴
median : 범위의 중간값을 리턴
countif : 범위에서 기준을 만족하는 개수를 리턴
averageif : 범위에서 기준을 만족하는 항목들의 평균값을 리턴
sumif :범위에서 기준을 만족하는 항목들의 합계를 리턴
unique : 범위에서 중복이 없는 항목들의 요소를 리턴
count : 범위에서 숫자값들의 개수를 리턴
counta : 범위에서 요소들의 개수를 리턴
stdev : 표준편차를 계산함
 ```

### 타입
| 타입        | 예시            | 설명                                  |
|-------------|------------------|---------------------------------------|
| 숫자(Number) | 123, 3.14         | 수학 연산 가능                         |
| 문자열(Text) | "Hello", ABC123  | 텍스트 처리. 숫자처럼 보여도 연산 안 됨 |
| 날짜/시간   | 2025-06-26, 12:34 | 날짜 간 계산 가능. 사실상 숫자형      |
| 불리언(Boolean) | TRUE, FALSE     | 논리 연산 가능                         |
| 공백(Blank) | "" 또는 빈 셀      | 조건문에서 FALSE로 간주됨              |
| 에러(Error) | #VALUE!, #REF?    | 계산 불가 상태, 오류 발생             |

### 타입변환
스프레드시트에서는 대부분 자동 타입 변환이 일어남. 필요한 경우 명시적 함수로 타입 변환 가능.

#### 자동 변환 예시:
- "123" + 1 → 124 (문자열이 숫자로 변환됨)
- IF("abc", 1, 0) → "abc"는 TRUE로 간주됨
- "2025-01-01" → 날짜로 자동 인식됨

#### 명시적 변환 함수:

| 함수               | 설명                                 |
|--------------------|--------------------------------------|
| VALUE(text)        | 문자열을 숫자로 변환                |
| TO_PURE_NUMBER()   | 텍스트 형 숫자를 정수/실수로 변환   |
| TO_TEXT(value)     | 숫자/날짜를 텍스트로 변환           |
| TEXT(value, format)| 숫자나 날짜를 원하는 서식으로 출력  |
| DATE(y,m,d)        | 숫자를 날짜로 변환                   |
| ARRAYFORMULA()     | 여러 셀에 수식을 확장 적용           |
### 많이 보는 에러

| 에러 코드    | 의미                           | 원인 예시 |
|--------------|--------------------------------|-----------|
| `#VALUE!`    | 타입 오류                       | 숫자 계산에 문자가 섞인 경우 등 |
| `#NAME?`     | 함수 이름 오류                  | 함수명을 오타냈거나 정의되지 않은 이름 사용 시 |
| `#REF!`      | 참조 오류                       | 삭제된 셀을 참조하거나 유효하지 않은 범위 참조 |
| `#DIV/0!`    | 0으로 나누기 오류               | 분모가 0이거나 빈 셀일 때 나눗셈 수행 |
| `#N/A`       | 값 없음(Not Available)          | `VLOOKUP` 등에서 찾는 값을 못 찾은 경우 |
| `#NUM!`      | 수치 오류                       | 루트 음수, 너무 큰 숫자 계산 등 |
| `#NULL!`     | 널 연산자 오류(거의 안 씀)      | `A1 A2`처럼 잘못된 수식 사용 시 발생 |

#### 참고:
- 오류는 대부분 수식 작성 시의 데이터 타입 불일치, 잘못된 범위, 또는 함수 사용법 실수에서 발생함
- 오류를 방지하려면 `ISERROR`, `IFERROR`, `ISNA` 같은 방어적 함수 사용 가능


### Pivot Table

피벗 테이블(Pivot Table)은 많은 데이터를 요약하고 집계하는 데 사용하는 도구이다.

#### 사용 목적:
- 범주별 합계, 평균, 개수 등을 빠르게 구할 수 있음
- 데이터를 그룹화하여 비교/분석 가능
- 조건별로 집계된 통계 수치를 도출할 수 있음

#### 생성 방법:
1. 데이터 전체를 선택
2. 상단 메뉴 → `삽입` → `피벗 테이블` 선택
3. 새 시트 또는 기존 시트에 테이블 삽입
4. 행, 열, 값, 필터에 원하는 필드 추가

#### 주요 용어:
- **행(Row)**: 분석 기준이 되는 그룹 (예: 카테고리, 날짜 등)
- **열(Column)**: 교차 비교 기준
- **값(Values)**: 합계, 평균 등 집계할 값
- **필터(Filter)**: 조건에 맞는 데이터만 보고 싶을 때

#### 예시:
| 날짜 | 카테고리 | 금액 |
|------|----------|------|
| 6/1  | 식비     | 12000 |
| 6/1  | 교통     | 2000  |
| 6/2  | 식비     | 8000  |

→ 카테고리별 금액 합계 피벗 테이블 생성 시:

| 카테고리 | 금액 합계 |
|----------|-----------|
| 교통     | 2000      |
| 식비     | 20000     |

#### 추가 팁:
- 피벗 테이블 안에서도 `값` 필드의 요약 함수를 평균, 최댓값 등으로 변경 가능
- `슬라이서`를 사용하면 필터를 더 직관적으로 조작할 수 있음


## 데이터 정제
### 결측값처리
`isblank`:셀이 비어있는지 여부를 판단해서 비어있으면 true를 반환

### 정규표현식(regex)
- LLM모델에게 원하는 바를 전달해서 만드는게 편함(cursor,claude,gemini,gpt)
- 원하는 데이터의 형식을 알고 있는게 중요함
- regex실험사이트 [https://regex101.com/]

### 필터
- 문서를 표로 만든다음에 필터적용
- `filter`함수를 통해서 필터 적용

### 이상값 탐지
- z-score란: 값이 평균에서 얼마나 떨어져 있는지를 표준편차 단위로 나타낸 것  
  $$
  Z = \frac{X - \mu}{\sigma}
  $$
- z-score가 신뢰구간보다 크면 이상치임

### 이상값 처리
- 평균으로 대체
- 중간값으로 대체
- 윈저화(상하위 5%값으로 대체, 하위 5%보다 작으면 하위 5%의 값으로 변환, 상위 5%면 반대)

